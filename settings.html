<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>AI Image Studio — Settings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
      /* --- utilities để canh hàng input + nút --- */
    .input-inline{
      display:grid;
      grid-template-columns: 1fr auto auto; /* input | Add | Paste */
      gap:8px;
      align-items:center;
    }
    .input-inline input{ width:100% }

    /* export/import + badge trên cùng 1 hàng */
    .actions-inline{
      display:flex; gap:8px; align-items:center; flex-wrap:wrap;
    }

    /* fix khoảng cách list: đừng phân bố đều theo chiều dọc */
    .tpl-list{ align-content:start }        /* quan trọng: dồn item lên trên */

    :root{
      --bg:#0b1324;--card:#0f1a33;--muted:#9ca3af;--stroke:#1f2a44;--text:#e5e7eb;
      --accent:#7c3aed;--accent2:#22d3ee;--danger:#ef4444;--ok:#22c55e;
      --glass:linear-gradient(180deg,rgba(15,26,51,.95),rgba(11,19,36,.9));
    }

    html,body{
      height:100%;margin:0;overflow:hidden;
      background:
        radial-gradient(1200px 600px at 20% 0%,#0f172a 0%,#0b1324 40%,#0b1324 100%),
        radial-gradient(600px 300px at 100% 100%, rgba(34,211,238,.08), transparent 70%);
      color:var(--text);
      font:14px/1.45 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial
    }

    .wrap{
      height:calc(100vh - 32px);
      max-width:1300px; margin:16px auto; padding:0 16px;
      display:flex; flex-direction:column; gap:12px;
      animation: fadeIn .5s ease-out;
    }
    @keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}

    h1{
      margin:0;font-size:22px;letter-spacing:.3px;font-weight:900;
      background:linear-gradient(90deg,#a78bfa,#22d3ee,#f472b6);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      filter: drop-shadow(0 4px 24px rgba(124,58,237,.25));
    }

    .tabs{display:flex;gap:10px;position:relative}
    .tab{
      background:var(--glass);border:1px solid var(--stroke);
      padding:10px 14px;border-radius:12px;cursor:pointer;color:#bcd3ff;
      box-shadow:0 10px 30px rgba(0,0,0,.15);
      display:flex;align-items:center;gap:8px;position:relative;overflow:hidden;
      transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
      user-select:none;
    }
    .tab:hover{ transform: translateY(-1px); box-shadow:0 14px 36px rgba(0,0,0,.2) }
    .tab.active{
      background:#131f3d;color:#fff;border-color:#23335a;
      box-shadow:0 0 0 2px rgba(124,58,237,.25), 0 12px 40px rgba(0,0,0,.28)
    }
    .tab .dot{
      width:8px;height:8px;border-radius:50%;
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      box-shadow:0 0 10px var(--accent2);
      animation: pulse 1.6s ease-in-out infinite;
    }
    @keyframes pulse{0%,100%{transform:scale(.9);opacity:.9}50%{transform:scale(1.15);opacity:1}}

    .tabs::after{
      content:""; position:absolute; left:0; bottom:-2px; height:3px; width:110px;
      background:linear-gradient(90deg,var(--accent),var(--accent2)); border-radius:4px;
      filter: drop-shadow(0 0 10px rgba(34,211,238,.35));
      transition: transform .35s cubic-bezier(.22,.88,.32,1.1), width .35s;
      transform: translateX(var(--tab-x,0)); width: var(--tab-w,110px)
    }

    .board{
      flex:1 1 auto; min-height:0;
      display:flex; flex-direction:column; gap:12px;
      background:var(--glass); border:1px solid var(--stroke); border-radius:16px;
      box-shadow:0 16px 50px rgba(0,0,0,.25); padding:14px 14px 12px;
      position:relative; overflow:hidden; isolation:isolate;
    }
    .board::before{
      content:""; position:absolute; inset:-1px; border-radius:16px;
      background: conic-gradient(from 180deg at 50% 50%, #7c3aed, #22d3ee, #f472b6, #7c3aed);
      filter: blur(18px) saturate(140%); opacity:.08;
      z-index:-1; animation: spin 18s linear infinite;
    }
    @keyframes spin{to{transform:rotate(1turn)}}

    .row{display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center}
    .muted{color:var(--muted)}
    .badge{padding:4px 8px;background:#122042;border:1px solid #23335a;border-radius:999px;color:#bcd3ff;font-size:12px;white-space:nowrap}

    input[type="text"], textarea{
      width:95%;padding:12px;border-radius:10px;border:1px solid var(--stroke);
      background:#0b1324;color:var(--text); transition: box-shadow .25s, border-color .25s;
    }
    input[type="text"]:focus, textarea:focus{
      border-color:#2a49ff88;
      box-shadow:0 0 0 3px rgba(34,211,238,.18), 0 6px 24px rgba(0,0,0,.25) inset;
      outline:none;
    }
    textarea{height:180px;resize:none}

    .btn{
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:800;
      box-shadow:0 10px 30px rgba(0,0,0,.18);
      position:relative; overflow:hidden;
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
    }
    .btn::after{
      content:""; position:absolute; top:0; left:-120%; width:120%; height:100%;
      background: linear-gradient(110deg, transparent 30%, rgba(255,255,255,.25) 50%, transparent 70%);
      transform:skewX(-22deg); transition: left .6s ease;
    }
    .btn:hover{ transform: translateY(-1px); box-shadow:0 14px 36px rgba(0,0,0,.24) }
    .btn:hover::after{ left:120% }
    .btn.ghost{background:#0f1a33;border:1px solid var(--stroke);color:#e5e7eb}
    .btn.danger{background:var(--danger)}
    .btn.small{padding:6px 10px;font-weight:700;border-radius:9px}

    .hide{display:none !important;}

    .tpl-layout{
      flex:1 1 auto; min-height:0;
      display:grid; gap:12px;
      grid-template-columns: 0.55fr 0.45fr;
    }
    .panel{
      background:rgba(255,255,255,.03); border:1px solid var(--stroke);
      border-radius:12px; padding:12px; min-height:0; display:flex; flex-direction:column; gap:10px;
      animation: rise .45s ease both;
    }
    @keyframes rise{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

    .tpl-list{
      display:grid; gap:10px;
      height: calc(100% - 120px);
      overflow:hidden;
    }
    .tpl-card{
      border:1px solid var(--stroke); background:#0b1324; border-radius:12px; padding:10px;
      display:flex; flex-direction:column; gap:8px; min-height:96px; max-height:135px;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .tpl-card:hover{
      transform: translateY(-2px);
      border-color:#2b3e72; box-shadow:0 10px 26px rgba(0,0,0,.28);
    }
    .title-line{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .tname{font-weight:800}
    .snippet{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size:12px; color:#cbd5e1; opacity:.9;
      display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden;
    }
    .btns{display:flex; gap:8px; justify-content:flex-end}

    .pagi{display:flex; gap:8px; align-items:center; justify-content:center; margin-top:auto}
    .pagi .pg{
      padding:6px 10px;border-radius:8px;border:1px solid #1f2a44;background:#101a33;color:#cde1ff;cursor:pointer;
      transition: transform .18s ease, background .18s ease, color .18s ease, box-shadow .18s ease;
    }
    .pagi .pg:hover{ transform: translateY(-1px); background:#122042; box-shadow:0 6px 18px rgba(0,0,0,.22) }
    .pagi .pg.active{background:linear-gradient(90deg,#7c3aed,#22d3ee);color:#fff;border-color:transparent}

    .key-grid{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:center}

    .board::after{
      content:""; position:absolute; inset:-40%;
      background:conic-gradient(from 0deg,#7c3aed,#22d3ee,#f472b6,#7c3aed);
      filter:blur(70px) saturate(140%); opacity:.09; animation:spin 18s linear infinite; pointer-events:none;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>AI Image Studio — Settings</h1>

    <div class="tabs" id="tabs">
      <div class="tab active" data-v="keys"><span class="dot"></span>API Keys</div>
      <div class="tab" data-v="tpl"><span class="dot"></span>Prompt Template </div>
      <div class="tab" data-v="samples"><span class="dot"></span>Product Sample</div>
      <div class="tab" data-v="refs"><span class="dot"></span>Artwork References</div>
    </div>

    <!-- ===== Keys ===== -->
    <section id="view-keys" class="board">
      <div class="panel">
        <div class="row" style="align-items:end">
          <div>
            <div class="muted" style="font-weight:700;margin-bottom:6px">Google AI API Key</div>
            <div class="key-grid" style="margin-bottom:10px">
              <input id="gkey" type="text" placeholder="AIza..." />
              <button class="btn small" id="saveKeys">Save</button>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="btn ghost small" id="testBtn">Test Google AI</button>
              <span id="testRes" class="badge">Standby</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== Templates ===== -->
    <section id="view-tpl" class="board hide">
      <div class="tpl-layout">
        <div class="panel">
          <div class="title-line" style="margin-bottom:2px">
            <div class="muted" style="font-weight:800">Template Editor</div>
            <div style="display:flex;gap:8px">
              <button class="btn ghost small" id="exportJson">Export JSON</button>
              <button class="btn ghost small" id="importJson">Import JSON</button>
              <input id="importFile" type="file" accept="application/json" class="hide" />
            </div>
          </div>

          <div>
            <div class="muted" style="font-weight:700;margin-bottom:6px">Template Name</div>
            <input id="tplName" type="text" placeholder="" />
          </div>

          <div>
            <div class="muted" style="font-weight:700;margin-bottom:6px">Template Prompt</div>
            <textarea id="tplPrompt" style="height:280px" placeholder="One prompt per line (optional), or a single prompt…"></textarea>
          </div>

          <div>
            <button class="btn" id="addTpl"><span id="addTplLabel">Add Template</span></button>
            <span id="msg2" class="muted" style="margin-left:10px"></span>
          </div>
        </div>

          <div class="panel rightPanel" id="rightPanel">
          <div class="title-line">
            <div class="muted" style="font-weight:800">Saved Templates</div>
            <div class="badge" id="metaBadge">0 Total • Page 1/1</div>
          </div>

          <div id="list" class="tpl-list"></div>
          <div class="pagi" id="pagi"></div>
        </div>
      </div>
    </section>

    <!-- ===== Samples ===== -->
    <section id="view-samples" class="board hide">
      <div class="tpl-layout" id="samplesRightPanel">
        <div class="panel">
          <div style="font-weight:700;margin-bottom:6px" class="muted">Sample Name</div>
          <div class="input-inline">
            <input id="sampleName" type="text" placeholder="kitchen towel base…" />
            <input id="sampleImportFile" type="file" accept="image/*,application/json" multiple style="display:none" />
            <button class="btn small" id="addSampleBtn">Add</button>
            <button class="btn small" id="pasteSampleBtn">Paste</button>
          </div>

          <div class="muted" style="margin-top:8px">
          </div>

          <div class="actions-inline" style="margin-top:8px">
            <button class="btn ghost small" id="exportSamples">Export JSON</button>
            <button class="btn ghost small" id="importSamples">Import JSON</button>
            <span id="sampleMsg" class="badge">Ready</span>
          </div>
        </div>

        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div class="muted">Saved Samples</div>
            <div class="badge" id="sampleMeta">0 total</div>
          </div>
          <div id="sampleList" class="tpl-list"></div>
          <div id="samplePagi" class="pagi"></div>
        </div>
      </div>
    </section>

    <!-- ===== Artwork References (NEW) ===== -->
    <section id="view-refs" class="board hide">
      <div class="tpl-layout" id="refsRightPanel">

        <!-- Left: form -->
        <div class="panel">
          <div class="muted" style="font-weight:700;margin-bottom:6px">Reference Name</div>
          <div class="input-inline">
            <input id="refName" type="text" placeholder="floral pattern…" />
            <input id="refImportFile" type="file" accept="image/*,application/json" multiple style="display:none" />
            <button class="btn small" id="addRefBtn">Add</button>
            <button class="btn small" id="pasteRefBtn">Paste</button>
          </div>

          <div class="muted" style="margin-top:8px">
          </div>

          <div class="actions-inline" style="margin-top:8px">
            <button class="btn ghost small" id="exportRefs">Export JSON</button>
            <button class="btn ghost small" id="importRefs">Import JSON</button>
            <span id="refMsg" class="badge">Ready</span>
          </div>
        </div>

        <!-- Right: list -->
        <div class="panel rightPanel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div class="muted">Saved Artwork References</div>
            <div class="badge" id="refMeta">0 total</div>
          </div>
          <div id="refList" class="tpl-list"></div>
          <div id="refPagi" class="pagi"></div>
        </div>

      </div>
    </section>

  </div>
  <script src="config.js"></script>
  <script src="settings.js"></script>
</body>
</html>
